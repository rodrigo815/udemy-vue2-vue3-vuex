/**
 *  Copyright 2021 Thorsten Luenborg 
 *  @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).PortalVue={},e.Vue)}(this,(function(e,t){"use strict";const o=Symbol("wormhole");function n(){const e=t.inject(o);if(!e)throw new Error("\n    [portal-vue]: Necessary Injection not found. Make sur you installed the plugin properly.");return e}const r="undefined"!=typeof window;var a=t.defineComponent({compatConfig:{MODE:3},name:"portal",props:{disabled:{type:Boolean},name:{type:[String,Symbol],default:()=>Symbol()},order:{type:Number},slotProps:{type:Object,default:()=>({})},to:{type:String,default:()=>String(Math.round(1e7*Math.random()))}},setup:(e,{slots:o})=>(function(e,o){const a=n();function l(){if(!r)return;const{to:t,name:n,order:l}=e;o.default?a.open({to:t,from:n,order:l,content:o.default}):s()}function s(t){a.close({to:null!=t?t:e.to,from:e.name})}t.onMounted((()=>{e.disabled||l()})),t.onUpdated((()=>{e.disabled?s():l()})),t.onBeforeUnmount((()=>{s()})),t.watch((()=>e.to),((t,o)=>{e.disabled||(o&&o!==t&&s(o),l())}))}(e,o),()=>e.disabled&&o.default?o.default(e.slotProps):null)});const l=(e,{slots:t})=>{var o;return null===(o=t.default)||void 0===o?void 0:o.call(t)};var s=t.defineComponent({compatConfig:{MODE:3},name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slotProps:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:o,slots:r}){const a=n(),s=t.computed((()=>{const t=a.getContentForTarget(e.name,e.multiple),o=r.wrapper,n=t.map((t=>t.content(e.slotProps))),l=o?n.flatMap((e=>e.length?o(e):[])):n.flat(1);return{vnodes:l,vnodesFn:()=>l}}));return t.watch(s,(({vnodes:t})=>{const n=t.length>0,r=a.transports.get(e.name),l=r?[...r.keys()]:[];o("change",{hasContent:n,sources:l})}),{flush:"post"}),()=>{var e;return!!s.value.vnodes.length?[t.h("div",{style:"display: none",key:"__portal-vue-hacky-scoped-slot-repair__"}),t.h(l,s.value.vnodesFn)]:null===(e=r.default)||void 0===e?void 0:e.call(r)}}});function u(e=!0){const o=t.reactive(new Map);const n={open:function(e){if(!r)return;const{to:t,from:n,content:a,order:l=1/0}=e;if(!t||!n||!a)return;o.has(t)||o.set(t,new Map);const s={to:t,from:n,content:a,order:l};o.get(t).set(n,s)},close:function(e){const{to:t,from:n}=e;if(!t||!n)return;const r=o.get(t);r&&(r.delete(n),r.size||o.delete(t))},transports:o,getContentForTarget:function(e,t){const n=o.get(e);if(!n)return[];const r=Array.from((null==n?void 0:n.values())||[]);return t?(a=(e,t)=>e.order-t.order,r.map(((e,t)=>[t,e])).sort((function(e,t){return a(e[1],t[1])||e[0]-t[0]})).map((e=>e[1]))):[r.pop()];var a}};return e?t.readonly(n):n}const d=u();function i(e,t={}){var n;!1!==t.portalName&&e.component(t.portalName||"Portal",a),!1!==t.portalTargetName&&e.component(t.portalTargetName||"PortalTarget",s);const r=null!==(n=t.wormhole)&&void 0!==n?n:d;e.provide(o,r)}const p=d;e.Portal=a,e.PortalTarget=s,e.Wormhole=p,e.createWormhole=u,e.default=i,e.install=i,e.mountPortalTarget=function(e,o){var n;const r=t.createApp({render:()=>t.h(s,e)});if(!e.multiple){const e=null!==(n=t.getCurrentInstance().provides)&&void 0!==n?n:{};r._context.provides=Object.create(e)}t.onMounted((()=>{r.mount(o)})),t.onBeforeUnmount((()=>{r.unmount()}))},e.provideWormhole=function(e){t.provide(o,e)},e.useWormhole=n,e.version="3.0.0-beta.0",Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
